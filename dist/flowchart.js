webpackJsonp([0],[function(t,e,i){"use strict";function s(t,e){for(var i in e)t.attr(i,e[i])}Object.defineProperty(e,"__esModule",{value:!0}),e.default={setAttr:s}},,,,,,,,,,function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var h=i(2),n=s(h),r=i(3),a=s(r),o=i(4),u=(s(o),function(){function t(e,i,s){return(0,n.default)(this,t),this.paper=e,this.id=i.id,this.type=i.type,this.from=i.from,this.to=i.to,this.text=i.text,this.data=i.data,this.options=s,this.render(),this}return(0,a.default)(t,[{key:"render",value:function(){var t={top:this.from.top,right:this.from.right,bottom:this.from.bottom,left:this.from.left,center:this.from.center},e={top:this.to.top,right:this.to.right,bottom:this.to.bottom,left:this.to.left,center:this.to.center},i=t.center.x-e.center.x,s=t.center.y-e.center.y,h=-i,n=s,r={},a=[];return Math.abs(i)<Math.abs(s)?(n>0?(r.from=t.top,r.to=e.bottom):(r.from=t.bottom,r.to=e.top),i=r.from.x-r.to.x,s=r.from.y-r.to.y,h=-i,n=s,a=[{x:r.from.x,y:r.from.y-n/2},{x:r.from.x+h/2,y:r.from.y-n/2},{x:r.from.x+h,y:r.from.y-n/2}]):(h<0?(r.from=t.left,r.to=e.right):(r.from=t.right,r.to=e.left),i=r.from.x-r.to.x,s=r.from.y-r.to.y,h=-i,n=s,a=[{x:r.from.x+h/2,y:r.from.y},{x:r.from.x+h/2,y:r.from.y-n/2},{x:r.from.x+h/2,y:r.from.y-n}]),this.drawLine(r,a),this}},{key:"refresh",value:function(){return this.render(),this}},{key:"drawLine",value:function(t,e){for(var i=["M",t.from.x,t.from.y,"L"],s={x:(t.from.x+t.to.x)/2,y:(t.from.y+t.to.y)/2},h=0,n=e.length;h<n;h++)i.push(e[h].x,e[h].y);if(i.push(t.to.x,t.to.y),this.line)this.line.path.attr({path:i});else{if(this.line=this.paper.set(),this.text){this.line.text=this.paper.text(0,0,this.text),this.line.text.attr({"text-anchor":"start"});for(var r="",a=this.options.maxWidth||120,o=0,u=this.text.length;o<u;o++)this.line.text.attr("text",r+this.text[o]),r+=this.line.text.getBBox().width>a?"\n"+this.text[o]:this.text[o];for(var l in this.options.line.text)this.line.text.attr(l,this.options.line.text[l]);this.line.push(this.line.text)}this.line.path=this.paper.path(i);for(var f in this.options.line.line)this.line.path.attr(f,this.options.line.line[f]);this.line.push(this.line.path)}if(this.line.text){var p=s.x-this.line.text.getBBox().width/2,d=s.y;this.line.text.transform("t"+p+","+d)}return this}}]),t}());e.default=u},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var h=i(2),n=s(h),r=i(3),a=s(r),o=i(4),u=s(o),l=i(17),f=s(l),p=function(){function t(e,i,s){return(0,n.default)(this,t),this.paper=e,this.data=i,this.to=i.to,this.id=i.id,this.options=s,this.types=f.default,this.shape=this.paper.set(),this.shape.shape=null,this.shape.text=null,this.render(),this}return(0,a.default)(t,[{key:"set",value:function(t,e){return u.default.isNumber(t)&&u.default.isNumber(e)&&this.shape.transform("t"+t+","+e),this}},{key:"setX",value:function(t){return u.default.isNumber(t)&&this.shape.transform("t"+t+","+this.y),this}},{key:"setY",value:function(t){return u.default.isNumber(t)&&this.shape.transform("t"+this.x+","+t),this}},{key:"shiftX",value:function(t){return u.default.isNumber(t)&&this.shape.transform("t"+(this.x+t)+","+this.y),this}},{key:"shiftY",value:function(t){return u.default.isNumber(t)&&this.shape.transform("t"+this.x+","+(this.y+t)),this}},{key:"render",value:function(){var t=this.paper,e=this.data,i=this.options,s=e.type;if(!this.types[s])throw new Error("没有["+s+"]对应的解析方法");return this.types[s].call(this,t,e,i),this.set(Number(e.x),Number(e.y)),this}},{key:"click",value:function(t){var e=this;return this.shape.click(function(i,s,h){u.default.isFunction(t)&&t(i,e)}),this}},{key:"dblclick",value:function(t){var e=this;return this.shape.dblclick(function(i,s,h){u.default.isFunction(t)&&t(i,e)}),this}},{key:"draggable",value:function(t){var e=this;return this.shape.drag(function(i,s,h,n,r){var a=i+e.shape.ox,o=s+e.shape.oy;e.set(a,o),t&&u.default.isFunction(t.onmove)&&t.onmove(r,e,i,s)},function(i,s,h){e.shape.ox=e.x,e.shape.oy=e.y,t&&u.default.isFunction(t.onstart)&&t.onstart(h,e)},function(i){delete e.shape.ox,delete e.shape.oy,t&&u.default.isFunction(t.onend)&&t.onend(i,e)}),this}},{key:"hover",value:function(t){return this.shape.hover(function(e){this.shape.shape.animate({fill:"#00ffff","fill-opacity":.5,"z-index":1e3},500),t&&u.default.isFunction(t.in)&&t.in(e,this)},function(e){this.shape.shape.animate({fill:"none","fill-opacity":0,"z-index":1e3},500),t&&u.default.isFunction(t.out)&&t.out(e,this)},this,this),this}},{key:"width",get:function(){return this.shape.getBBox().width}},{key:"height",get:function(){return this.shape.getBBox().height}},{key:"x",get:function(){return this.shape.getBBox().x}},{key:"y",get:function(){return this.shape.getBBox().y}},{key:"center",get:function(){return{x:this.x+this.width/2,y:this.y+this.height/2}}},{key:"top",get:function(){return{x:this.x+this.width/2,y:this.y}}},{key:"right",get:function(){return{x:this.x+this.width,y:this.y+this.height/2}}},{key:"bottom",get:function(){return{x:this.x+this.width/2,y:this.y+this.height}}},{key:"left",get:function(){return{x:this.x,y:this.y+this.height/2}}}]),t}();e.default=p},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){for(var e=t.sort(function(t,e){return!(t.level<=e.level)}),i={},s=0;s<e.length;s++)i[e[s].level]||(i[e[s].level]=[]),i[e[s].level].push(e[s]);var h=[];for(var n in i)i[n]=i[n].sort(function(t,e){return!(t.id<=e.id)}),h.push(i[n]);return h};e.default={dataProcessing:s}},,function(t,e){t.exports={line:{line:{stroke:"#666666","stroke-width":2,"arrow-end":"classic-wide-long"},text:{fill:"#666666","font-size":13,"font-family":"Segoe UI, Microsoft YaHei, Helvetica, Arial, sans-serif"}},text:{fill:"#666666","font-size":13,"font-family":"Segoe UI, Microsoft YaHei, Helvetica, Arial, sans-serif"},shape:{fill:"#ffffff",stroke:"#666666","fill-opacity":0,"stroke-width":2},textPadding:10,maxWidth:80,autolayout:!0,clickable:!1,dblclickable:!1,draggable:!1,hoverable:!1,spacing:{x:80,y:80},paperPadding:{x:30,y:30},symmetricallayout:!0}},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function h(t,e,i,s){var h=void 0,n=void 0,a="M{0},{1}";for(h=2,n=2*i.length+2;h<n;h+=2)a+=" L{"+h+"},{"+(h+1)+"}";var o=[e.x,e.y];for(h=0,n=i.length;h<n;h++)o.push(i[h].x),o.push(i[h].y);var u=t.path(a,o);return r.default.setAttr(u,s.shape),u}Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),r=s(n),a="condition";e.default={type:a,fn:function(t,e,i){var s=this.paper.text(0,0,e.text);r.default.setAttr(s,i.text);var n=i.textPadding||10;s.attr({"text-anchor":"start"}),this.shape.push(s);for(var a=i.maxWidth||120,o="",u=0,l=e.text.length;u<l;u++)s.attr("text",o+e.text[u]),o+=s.getBBox().width>a?"\n"+e.text[u]:e.text[u];e.href&&s.attr("href",e.href);var f=s.getBBox(),p=f.width+3*n;p+=p/2;var d=f.height+2*n;d+=d/2,d=Math.max(.5*p,d);var c=p/4,x=d/4;s.attr({x:c+n/2});var v={x:c,y:x},g=[{x:c-p/4,y:x+d/4},{x:c-p/4+p/2,y:x+d/4+d/2},{x:c-p/4+p,y:x+d/4},{x:c-p/4+p/2,y:x+d/4-d/2},{x:c-p/4,y:x+d/4}],y=h(this.paper,v,g,i);y.insertBefore(s),s.attr({y:y.getBBox().height/2}),this.shape.push(y),this.shape.shape=y,this.shape.text=s}}},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var h=i(0),n=s(h),r="end";e.default={type:r,fn:function(t,e,i){var s=this.paper.text(0,0,e.text);n.default.setAttr(s,i.text);var h=i.textPadding||10;s.attr({"text-anchor":"start",x:h}),this.shape.push(s);for(var a=i.maxWidth||160,o="",u=0,l=e.text.length;u<l;u++)s.attr("text",o+e.text[u]),o+=s.getBBox().width>a?"\n"+e.text[u]:e.text[u];e.href&&s.attr("href",e.href);var f=s.getBBox(),p=i[r]&&i[r].radius||20,d=this.paper.rect(0,0,0,0,p);n.default.setAttr(d,i.shape),d.attr({width:f.width+2*h,height:f.height+2*h}),this.shape.push(d),d.insertBefore(s),s.attr({y:d.getBBox().height/2}),this.shape.shape=d,this.shape.text=s}}},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});for(var h=i(19),n=s(h),r=i(16),a=s(r),o=i(15),u=s(o),l=i(18),f=s(l),p=[n.default,a.default,u.default,f.default],d={},c=0,x=p.length;c<x;c++){if(d[p[c].type])throw new Error("已经存在["+p[c].type+"]类型了");d[p[c].type]=p[c].fn}e.default=d},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var h=i(0),n=s(h),r="operation";e.default={type:r,fn:function(t,e,i){var s=this.paper.text(0,0,e.text);n.default.setAttr(s,i.text);var h=i.textPadding||10;s.attr({"text-anchor":"start",x:h}),this.shape.push(s);for(var a=i.maxWidth||160,o="",u=0,l=e.text.length;u<l;u++)s.attr("text",o+e.text[u]),o+=s.getBBox().width>a?"\n"+e.text[u]:e.text[u];e.href&&s.attr("href",e.href);var f=s.getBBox(),p=i[r]&&i[r].radius||20,d=this.paper.rect(0,0,0,0,p);n.default.setAttr(d,i.shape),d.attr({width:f.width+2*h,height:f.height+2*h}),this.shape.push(d),d.insertBefore(s),s.attr({y:d.getBBox().height/2}),this.shape.shape=d,this.shape.text=s}}},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var h=i(0),n=s(h),r="start";e.default={type:r,fn:function(t,e,i){var s=this.paper.text(0,0,e.text);n.default.setAttr(s,i.text);var h=i.textPadding||10;s.attr({"text-anchor":"start",x:h}),this.shape.push(s);for(var a=i.maxWidth||160,o="",u=0,l=e.text.length;u<l;u++)s.attr("text",o+e.text[u]),o+=s.getBBox().width>a?"\n"+e.text[u]:e.text[u];e.href&&s.attr("href",e.href);var f=s.getBBox(),p=i[r]&&i[r].radius||20,d=this.paper.rect(0,0,0,0,p);n.default.setAttr(d,i.shape),d.attr({width:f.width+2*h,height:f.height+2*h}),this.shape.push(d),d.insertBefore(s),s.attr({y:d.getBBox().height/2}),this.shape.shape=d,this.shape.text=s}}},,,,,,,,,,,,,,,function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var h=i(2),n=s(h),r=i(3),a=s(r),o=i(4),u=s(o),l=i(13),f=s(l),p=i(10),d=s(p),c=i(11),x=s(c),v=i(12),g=(s(v),i(14)),y=s(g),m=function(){function t(e,i,s){return(0,n.default)(this,t),this.$el=e,this.paper=(0,f.default)(e),this.data=this.setData(i),this.options=this.setOptions(s),this.$event={click:[],dblclick:[],draggable:[],hover:[]},this.shapes=[],this.lines=[],this.data.length&&this._render(),this}return(0,a.default)(t,[{key:"setPaper",value:function(t){var e=this.$el.offsetWidth,i=this.$el.offsetHeight,s=t.width,h=t.height;if(s<e&&(s=e),h<i&&(h=i),this.paper.setSize(s,h),u.default.isArray(this.lines))for(var n=this.lines.length-1;n>=0;n--)for(var r=0;r<this.lines[n].length;r++)this.lines[n][r].refresh();return this.paper}},{key:"setData",value:function(t){return this.data=u.default.isArray(t)?t:[],this.data}},{key:"setOptions",value:function(t){return this.options=u.default.merge(y.default,t),this.options}},{key:"_render",value:function(){for(var t=this.data,e=this.options.paperPadding,i=[],s=0,h=0,n=0,r=t.length;n<r;n++){var a=new x.default(this.paper,t[n],this.options);this._bindevent(a),a.x<e.x&&(s=e.x-a.left.x),a.y<e.y&&(h=e.y-a.y),i.push(a)}return this.shapes=i,this.options.autolayout?this.autolayout():this.shift(s,h),this.resize(),this._drawLine(),this}},{key:"_bindevent",value:function(t){var e=this;this.options.clickable&&t.click(function(t,i){for(var s=0,h=e.$event.click.length;s<h;s++)e.$event.click[s].call(i,t,i)}),this.options.dblclickable&&t.dblclick(function(t,i){for(var s=0,h=e.$event.dblclick.length;s<h;s++)e.$event.dblclick[s].call(i,t,i)}),this.options.draggable&&t.draggable({onstart:function(t,i){for(var s=0,h=e.$event.draggable.length;s<h;s++)e.$event.draggable[s].onstart&&e.$event.draggable[s].onstart.call(i,t,i)},onmove:function(t,i,s,h){for(var n=e.lines.length-1;n>=0;n--)e.lines[n].refresh();for(var r=0,a=e.$event.draggable.length;r<a;r++)e.$event.draggable[r].onmove&&e.$event.draggable[r].onmove.call(i,t,i,s,h)},onend:function(t,i){for(var s=0,h=e.$event.draggable.length;s<h;s++)e.$event.draggable[s].onend&&e.$event.draggable[s].onend.call(i,t,i)}}),this.options.hoverable&&t.hover({in:function(t,i){for(var s=0,h=e.$event.hover.length;s<h;s++)e.$event.hover[s].in&&e.$event.hover[s].in.call(i,t,i)},out:function(t,i){for(var s=0,h=e.$event.hover.length;s<h;s++)e.$event.hover[s].out&&e.$event.hover[s].out.call(i,t,i)}})}},{key:"refresh",value:function(){return this.paper.clear(),this._render(),this}},{key:"resize",value:function(){for(var t=this.shapes,e=this.options.paperPadding,i=void 0,s=void 0,h=0;h<t.length;h++)0===h&&(i=t[h].left.x,s=t[h].right.x),i>=t[h].left.x&&(i=t[h].left.x),s<=t[h].right.x&&(s=t[h].right.x);var n=i-e.x,r=0,a=s+e.x-n,o=this.height;return this.width=a,this.paper.setViewBox(n,r,a,o,!0),this}},{key:"shift",value:function(t,e){for(var i=this.shapes,s=this.options.paperPadding,h=this.$el.offsetWidth,n=this.$el.offsetHeight,r=0;r<i.length;r++)i[r].shiftX(t),i[r].shiftY(e),h<i[r].right.x+s.x&&(h=i[r].right.x+s.x),n<i[r].bottom.y+s.y&&(n=i[r].bottom.y+s.y);return this.width=h,this.height=n,this}},{key:"autolayout",value:function(){function t(e){e.autolayout=!0;for(var i=0,s=e.to.length;i<s;i++)for(var h=0,n=this.shapes.length;h<n;h++)if(e.to[i].to==this.shapes[h].id&&!this.shapes[h].autolayout){var r=e.center.x-this.shapes[h].width/2,a=e.bottom.y+this.options.spacing.y;r+=e.to.length%2==0&&this.options.symmetricalLayout?i%2==1?-(i+1)/2*(this.shapes[h].width/2+this.shapes[h].width/2+this.options.spacing.x):Math.ceil((i+1)/2)*(this.shapes[h].width/2+this.shapes[h].width/2+this.options.spacing.x):i%2==1?-Math.ceil(i/2)*(this.shapes[h].width/2+this.shapes[h].width/2+this.options.spacing.x):i/2*(this.shapes[h].width/2+this.shapes[h].width/2+this.options.spacing.x),this.shapes[h].set(r,a),t.call(this,this.shapes[h])}}for(var e=null,i=0,s=this.shapes.length;i<s;i++){for(var h=!1,n=0,r=this.shapes.length;n<r;n++)this.shapes[n].to.indexOf(this.shapes[i].id)!==-1&&(h=!0);if(!h){e=this.shapes[i];break}}if(e){var a=this.paper.width/2-e.width/2,o=this.options.paperPadding.y;e.set(a,o),t.call(this,e)}for(var u=0,l=0,f=0,p=this.shapes;f<p;f++)delete this.shapes.autolayout,u||(u=this.shapes[f].left.x),l||(l=this.shapes[f].top.y),u>this.shapes[f].left.x&&(u=this.options.paperPadding.x-this.shapes[f].left.x),l>this.shapes[f].top.x&&(l=this.options.paperPadding.y-this.shapes[f].top.y);return this.shift(u,l),this}},{key:"_drawLine",value:function(){for(var t=[],e=0,i=this.shapes.length;e<i;e++)for(var s=0,h=this.shapes.length;s<h;s++)for(var n=0,r=this.shapes[e].to.length;n<r;n++)if(this.shapes[e].to[n].to===this.shapes[s].id){var a=new d.default(this.paper,{id:this.shapes[e].to[n].id,type:this.shapes[e].to[n].type,from:this.shapes[e],to:this.shapes[s],text:this.shapes[e].to[n].text,data:this.shapes[e].to[n].data},this.options);t.push(a)}return this.lines=t,this}},{key:"click",value:function(t){return u.default.isFunction(t)&&this.$event.click.push(t),this}},{key:"dblclick",value:function(t){return u.default.isFunction(t)&&this.$event.dblclick.push(t),this}},{key:"draggable",value:function(t){if(u.default.isFunction(t)&&(t={onmove:t}),u.default.isObject(t)){var e={};u.default.isFunction(t.onstart)&&(e.onstart=t.onstart),u.default.isFunction(t.onmove)&&(e.onmove=t.onmove),u.default.isFunction(t.onend)&&(e.onend=t.onend),this.$event.draggable.push(e)}return this}},{key:"hover",value:function(t){if(u.default.isFunction(t)&&(t={in:t}),u.default.isObject(t)){var e={};u.default.isFunction(t.in)&&(e.in=t.in),u.default.isFunction(t.out)&&(e.out=t.out),this.$event.hover.push(e)}return this}},{key:"width",get:function(){return this.paper.width},set:function(t){this.setPaper({width:t,height:this.height})}},{key:"height",get:function(){return this.paper.height},set:function(t){return this.setPaper({width:this.width,height:t}),this}}]),t}();e.default=m}],[34]);